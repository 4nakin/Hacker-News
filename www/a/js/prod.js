/*
 FastClick: polyfill to remove click delays on browsers with touch UIs.

 @version 0.6.2
 @codingstandard ftlabs-jsv2
 @copyright The Financial Times Limited [All Rights Reserved]
 @license MIT License (see LICENSE.txt)
*/
(function(a){String.prototype.trim===a&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});Array.prototype.reduce===a&&(Array.prototype.reduce=function(b){if(void 0===this||null===this)throw new TypeError;var d=Object(this),c=d.length>>>0,f=0,h;if("function"!=typeof b)throw new TypeError;if(0==c&&1==arguments.length)throw new TypeError;if(2<=arguments.length)h=arguments[1];else{do{if(f in d){h=d[f++];break}if(++f>=c)throw new TypeError;}while(1)}for(;f<c;)f in d&&(h=b.call(a,
h,d[f],f,d)),f++;return h})})();
var Zepto=function(){function a(g){return null==g?String(g):F[Q.call(g)]||"object"}function b(g){return"function"==a(g)}function d(g){return null!=g&&g==g.window}function c(g){return null!=g&&g.nodeType==g.DOCUMENT_NODE}function f(g){return"object"==a(g)}function h(g){return f(g)&&!d(g)&&g.__proto__==Object.prototype}function l(g){return g instanceof Array}function s(g){return"number"==typeof g.length}function m(g){return g.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,
"$1_$2").replace(/_/g,"-").toLowerCase()}function q(g){return g in G?G[g]:G[g]=RegExp("(^|\\s)"+g+"(\\s|$)")}function r(g){return"children"in g?u.call(g.children):e.map(g.childNodes,function(g){if(1==g.nodeType)return g})}function x(g,a,b){for(p in a)b&&(h(a[p])||l(a[p]))?(h(a[p])&&!h(g[p])&&(g[p]={}),l(a[p])&&!l(g[p])&&(g[p]=[]),x(g[p],a[p],b)):a[p]!==n&&(g[p]=a[p])}function A(g,a){return a===n?e(g):e(g).filter(a)}function w(g,a,c,d){return b(a)?a.call(g,c,d):a}function t(g,a){var b=g.className,
c=b&&b.baseVal!==n;if(a===n)return c?b.baseVal:b;c?b.baseVal=a:g.className=a}function C(g){var a;try{return g?"true"==g||("false"==g?!1:"null"==g?null:isNaN(a=Number(g))?/^[\[\{]/.test(g)?e.parseJSON(g):g:a):g}catch(b){return g}}function k(g,a){a(g);for(var b in g.childNodes)k(g.childNodes[b],a)}var n,p,e,y,z=[],u=z.slice,j=z.filter,B=window.document,D={},G={},H=B.defaultView.getComputedStyle,K={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},L=/^\s*<(\w+|!)[^>]*>/,
R=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,M=/^(?:body|html)$/i,S="val css html text data width height offset".split(" "),I=B.createElement("table"),N=B.createElement("tr"),O={tr:B.createElement("tbody"),tbody:I,thead:I,tfoot:I,td:N,th:N,"*":B.createElement("div")},T=/complete|loaded|interactive/,U=/^\.([\w-]+)$/,V=/^#([\w-]*)$/,W=/^[\w-]+$/,F={},Q=F.toString,v={},J,E,P=B.createElement("div");return v.matches=function(g,a){if(!g||1!==g.nodeType)return!1;var b=g.webkitMatchesSelector||
g.mozMatchesSelector||g.oMatchesSelector||g.matchesSelector;if(b)return b.call(g,a);var c,b=g.parentNode,d=!b;return d&&(b=P).appendChild(g),c=~v.qsa(b,a).indexOf(g),d&&P.removeChild(g),c},J=function(g){return g.replace(/-+(.)?/g,function(g,a){return a?a.toUpperCase():""})},E=function(g){return j.call(g,function(a,b){return g.indexOf(a)==b})},v.fragment=function(g,a,b){g.replace&&(g=g.replace(R,"<$1></$2>"));a===n&&(a=L.test(g)&&RegExp.$1);a in O||(a="*");var c,d,k=O[a];return k.innerHTML=""+g,d=
e.each(u.call(k.childNodes),function(){k.removeChild(this)}),h(b)&&(c=e(d),e.each(b,function(g,a){-1<S.indexOf(g)?c[g](a):c.attr(g,a)})),d},v.Z=function(g,a){return g=g||[],g.__proto__=e.fn,g.selector=a||"",g},v.isZ=function(g){return g instanceof v.Z},v.init=function(g,a){if(!g)return v.Z();if(b(g))return e(B).ready(g);if(v.isZ(g))return g;var c;if(l(g))c=j.call(g,function(g){return null!=g});else if(f(g))c=[h(g)?e.extend({},g):g],g=null;else if(L.test(g))c=v.fragment(g.trim(),RegExp.$1,a),g=null;
else{if(a!==n)return e(a).find(g);c=v.qsa(B,g)}return v.Z(c,g)},e=function(g,a){return v.init(g,a)},e.extend=function(g){var a,b=u.call(arguments,1);return"boolean"==typeof g&&(a=g,g=b.shift()),b.forEach(function(b){x(g,b,a)}),g},v.qsa=function(a,b){var d;return c(a)&&V.test(b)?(d=a.getElementById(RegExp.$1))?[d]:[]:1!==a.nodeType&&9!==a.nodeType?[]:u.call(U.test(b)?a.getElementsByClassName(RegExp.$1):W.test(b)?a.getElementsByTagName(b):a.querySelectorAll(b))},e.contains=function(a,b){return a!==
b&&a.contains(b)},e.type=a,e.isFunction=b,e.isWindow=d,e.isArray=l,e.isPlainObject=h,e.isEmptyObject=function(a){for(var b in a)return!1;return!0},e.inArray=function(a,b,c){return z.indexOf.call(b,a,c)},e.camelCase=J,e.trim=function(a){return a.trim()},e.uuid=0,e.support={},e.expr={},e.map=function(a,b){var c,d=[],k;if(s(a))for(k=0;k<a.length;k++)c=b(a[k],k),null!=c&&d.push(c);else for(k in a)c=b(a[k],k),null!=c&&d.push(c);return 0<d.length?e.fn.concat.apply([],d):d},e.each=function(a,b){var c;if(s(a))for(c=
0;c<a.length&&!1!==b.call(a[c],c,a[c]);c++);else for(c in a)if(!1===b.call(a[c],c,a[c]))break;return a},e.grep=function(a,b){return j.call(a,b)},window.JSON&&(e.parseJSON=JSON.parse),e.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){F["[object "+b+"]"]=b.toLowerCase()}),e.fn={forEach:z.forEach,reduce:z.reduce,push:z.push,sort:z.sort,indexOf:z.indexOf,concat:z.concat,map:function(a){return e(e.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return e(u.apply(this,
arguments))},ready:function(a){return T.test(B.readyState)?a(e):B.addEventListener("DOMContentLoaded",function(){a(e)},!1),this},get:function(a){return a===n?u.call(this):this[0<=a?a:a+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(a){return z.every.call(this,function(b,c){return!1!==a.call(b,c,b)}),this},filter:function(a){return b(a)?this.not(this.not(a)):
e(j.call(this,function(b){return v.matches(b,a)}))},add:function(a,b){return e(E(this.concat(e(a,b))))},is:function(a){return 0<this.length&&v.matches(this[0],a)},not:function(a){var c=[];if(b(a)&&a.call!==n)this.each(function(b){a.call(this,b)||c.push(this)});else{var d="string"==typeof a?this.filter(a):s(a)&&b(a.item)?u.call(a):e(a);this.forEach(function(a){0>d.indexOf(a)&&c.push(a)})}return e(c)},has:function(a){return this.filter(function(){return f(a)?e.contains(this,a):e(this).find(a).size()})},
eq:function(a){return-1===a?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!f(a)?a:e(a)},last:function(){var a=this[this.length-1];return a&&!f(a)?a:e(a)},find:function(a){var b,c=this;return"object"==typeof a?b=e(a).filter(function(){var a=this;return z.some.call(c,function(g){return e.contains(g,a)})}):1==this.length?b=e(v.qsa(this[0],a)):b=this.map(function(){return v.qsa(this,a)}),b},closest:function(a,b){var d=this[0],k=!1;for("object"==typeof a&&(k=e(a));d&&!(k?0<=
k.indexOf(d):v.matches(d,a));)d=d!==b&&!c(d)&&d.parentNode;return e(d)},parents:function(a){for(var b=[],d=this;0<d.length;)d=e.map(d,function(a){if((a=a.parentNode)&&!c(a)&&0>b.indexOf(a))return b.push(a),a});return A(b,a)},parent:function(a){return A(E(this.pluck("parentNode")),a)},children:function(a){return A(this.map(function(){return r(this)}),a)},contents:function(){return this.map(function(){return u.call(this.childNodes)})},siblings:function(a){return A(this.map(function(a,b){return j.call(r(b.parentNode),
function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return e.map(this,function(b){return b[a]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=null);if("none"==H(this,"").getPropertyValue("display")){var a=this.style,b;b=this.nodeName;var c,d;b=(D[b]||(c=B.createElement(b),B.body.appendChild(c),d=H(c,"").getPropertyValue("display"),c.parentNode.removeChild(c),"none"==d&&(d="block"),D[b]=
d),D[b]);a.display=b}})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){var c=b(a);if(this[0]&&!c)var d=e(a).get(0),k=d.parentNode||1<this.length;return this.each(function(b){e(this).wrapAll(c?a.call(this,b):k?d.cloneNode(!0):d)})},wrapAll:function(a){if(this[0]){e(this[0]).before(a=e(a));for(var b;(b=a.children()).length;)a=b.first();e(a).append(this)}return this},wrapInner:function(a){var c=b(a);return this.each(function(b){var d=e(this),k=d.contents();b=c?a.call(this,
b):a;k.length?k.wrapAll(b):d.append(b)})},unwrap:function(){return this.parent().each(function(){e(this).replaceWith(e(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(a){return this.each(function(){var b=e(this);(a===n?"none"==b.css("display"):a)?b.show():b.hide()})},prev:function(a){return e(this.pluck("previousElementSibling")).filter(a||"*")},next:function(a){return e(this.pluck("nextElementSibling")).filter(a||
"*")},html:function(a){return a===n?0<this.length?this[0].innerHTML:null:this.each(function(b){var c=this.innerHTML;e(this).empty().append(w(this,a,b,c))})},text:function(a){return a===n?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=a})},attr:function(a,b){var c;return"string"==typeof a&&b===n?0==this.length||1!==this[0].nodeType?n:"value"==a&&"INPUT"==this[0].nodeName?this.val():!(c=this[0].getAttribute(a))&&a in this[0]?this[0][a]:c:this.each(function(c){if(1===this.nodeType)if(f(a))for(p in a){c=
p;var d=a[p];null==d?this.removeAttribute(c):this.setAttribute(c,d)}else c=w(this,b,c,this.getAttribute(a)),null==c?this.removeAttribute(a):this.setAttribute(a,c)})},removeAttr:function(a){return this.each(function(){1===this.nodeType&&this.removeAttribute(a)})},prop:function(a,b){return b===n?this[0]&&this[0][a]:this.each(function(c){this[a]=w(this,b,c,this[a])})},data:function(a,b){var c=this.attr("data-"+m(a),b);return null!==c?C(c):n},val:function(a){return a===n?this[0]&&(this[0].multiple?e(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):
this[0].value):this.each(function(b){this.value=w(this,a,b,this.value)})},offset:function(a){if(a)return this.each(function(b){var c=e(this);b=w(this,a,b,c.offset());var d=c.offsetParent().offset();b={top:b.top-d.top,left:b.left-d.left};"static"==c.css("position")&&(b.position="relative");c.css(b)});if(0==this.length)return null;var b=this[0].getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:Math.round(b.width),height:Math.round(b.height)}},css:function(b,
c){if(2>arguments.length&&"string"==typeof b)return this[0]&&(this[0].style[J(b)]||H(this[0],"").getPropertyValue(b));var d="";if("string"==a(b))!c&&0!==c?this.each(function(){this.style.removeProperty(m(b))}):d=m(b)+":"+("number"==typeof c&&!K[m(b)]?c+"px":c);else for(p in b)!b[p]&&0!==b[p]?this.each(function(){this.style.removeProperty(m(p))}):d+=m(p)+":"+("number"==typeof b[p]&&!K[m(p)]?b[p]+"px":b[p])+";";return this.each(function(){this.style.cssText+=";"+d})},index:function(a){return a?this.indexOf(e(a)[0]):
this.parent().children().indexOf(this[0])},hasClass:function(a){return z.some.call(this,function(a){return this.test(t(a))},q(a))},addClass:function(a){return this.each(function(b){y=[];var c=t(this);w(this,a,b,c).split(/\s+/g).forEach(function(a){e(this).hasClass(a)||y.push(a)},this);y.length&&t(this,c+(c?" ":"")+y.join(" "))})},removeClass:function(a){return this.each(function(b){if(a===n)return t(this,"");y=t(this);w(this,a,b,y).split(/\s+/g).forEach(function(a){y=y.replace(q(a)," ")});t(this,
y.trim())})},toggleClass:function(a,b){return this.each(function(c){var d=e(this);w(this,a,c,t(this)).split(/\s+/g).forEach(function(a){(b===n?!d.hasClass(a):b)?d.addClass(a):d.removeClass(a)})})},scrollTop:function(){if(this.length)return"scrollTop"in this[0]?this[0].scrollTop:this[0].scrollY},position:function(){if(this.length){var a=this[0],b=this.offsetParent(),c=this.offset(),d=M.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(e(a).css("margin-top"))||0,c.left-=parseFloat(e(a).css("margin-left"))||
0,d.top+=parseFloat(e(b[0]).css("border-top-width"))||0,d.left+=parseFloat(e(b[0]).css("border-left-width"))||0,{top:c.top-d.top,left:c.left-d.left}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||B.body;a&&!M.test(a.nodeName)&&"static"==e(a).css("position");)a=a.offsetParent;return a})}},e.fn.detach=e.fn.remove,["width","height"].forEach(function(a){e.fn[a]=function(b){var k,j=this[0],u=a.replace(/./,function(a){return a[0].toUpperCase()});return b===n?d(j)?j["inner"+
u]:c(j)?j.documentElement["offset"+u]:(k=this.offset())&&k[a]:this.each(function(c){j=e(this);j.css(a,w(this,b,c,j[a]()))})}}),["after","prepend","before","append"].forEach(function(b,c){var d=c%2;e.fn[b]=function(){var b,g=e.map(arguments,function(c){return b=a(c),"object"==b||"array"==b||null==c?c:v.fragment(c)}),j,n=1<this.length;return 1>g.length?this:this.each(function(a,b){j=d?b:b.parentNode;b=0==c?b.nextSibling:1==c?b.firstChild:2==c?b:null;g.forEach(function(a){if(n)a=a.cloneNode(!0);else if(!j)return e(a).remove();
k(j.insertBefore(a,b),function(a){null!=a.nodeName&&"SCRIPT"===a.nodeName.toUpperCase()&&(!a.type||"text/javascript"===a.type)&&!a.src&&window.eval.call(window,a.innerHTML)})})})};e.fn[d?b+"To":"insert"+(c?"Before":"After")]=function(a){return e(a)[b](this),this}}),v.Z.prototype=e.fn,v.uniq=E,v.deserializeValue=C,e.zepto=v,e}();window.Zepto=Zepto;"$"in window||(window.$=Zepto);
(function(a){function b(a){var b=this.os={},f=this.browser={},h=a.match(/WebKit\/([\d.]+)/),l=a.match(/(Android)\s+([\d.]+)/),s=a.match(/(iPad).*OS\s([\d_]+)/),m=!s&&a.match(/(iPhone\sOS)\s([\d_]+)/),q=a.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),r=q&&a.match(/TouchPad/),x=a.match(/Kindle\/([\d.]+)/),A=a.match(/Silk\/([\d._]+)/),w=a.match(/(BlackBerry).*Version\/([\d.]+)/),t=a.match(/(BB10).*Version\/([\d.]+)/),C=a.match(/(RIM\sTablet\sOS)\s([\d.]+)/),k=a.match(/PlayBook/),n=a.match(/Chrome\/([\d.]+)/)||
a.match(/CriOS\/([\d.]+)/),p=a.match(/Firefox\/([\d.]+)/);if(f.webkit=!!h)f.version=h[1];l&&(b.android=!0,b.version=l[2]);m&&(b.ios=b.iphone=!0,b.version=m[2].replace(/_/g,"."));s&&(b.ios=b.ipad=!0,b.version=s[2].replace(/_/g,"."));q&&(b.webos=!0,b.version=q[2]);r&&(b.touchpad=!0);w&&(b.blackberry=!0,b.version=w[2]);t&&(b.bb10=!0,b.version=t[2]);C&&(b.rimtabletos=!0,b.version=C[2]);k&&(f.playbook=!0);x&&(b.kindle=!0,b.version=x[1]);A&&(f.silk=!0,f.version=A[1]);!A&&b.android&&a.match(/Kindle Fire/)&&
(f.silk=!0);n&&(f.chrome=!0,f.version=n[1]);p&&(f.firefox=!0,f.version=p[1]);b.tablet=!(!s&&!k&&!(l&&!a.match(/Mobile/)||p&&a.match(/Tablet/)));b.phone=!b.tablet&&!(!l&&!m&&!q&&!w&&!t&&!(n&&a.match(/Android/)||n&&a.match(/CriOS\/([\d.]+)/)||p&&a.match(/Mobile/)))}b.call(a,navigator.userAgent);a.__detect=b})(Zepto);
(function(a){function b(a){return a._zid||(a._zid=q++)}function d(a,d,p,e){d=c(d);if(d.ns)var f=RegExp("(?:^| )"+d.ns.replace(" "," .* ?")+"(?: |$)");return(m[b(a)]||[]).filter(function(a){return a&&(!d.e||a.e==d.e)&&(!d.ns||f.test(a.ns))&&(!p||b(a.fn)===b(p))&&(!e||a.sel==e)})}function c(a){a=(""+a).split(".");return{e:a[0],ns:a.slice(1).sort().join(" ")}}function f(b,c,d){"string"!=a.type(b)?a.each(b,d):b.split(/\s/).forEach(function(a){d(a,c)})}function h(d,n,p,e,l,h){var u=b(d),j=m[u]||(m[u]=
[]);f(n,p,function(b,u){var n=c(b);n.fn=u;n.sel=e;n.e in x&&(u=function(b){var c=b.relatedTarget;if(!c||c!==this&&!a.contains(this,c))return n.fn.apply(this,arguments)});n.del=l&&l(u,b);var p=n.del||u;n.proxy=function(a){var b=p.apply(d,[a].concat(a.data));return!1===b&&(a.preventDefault(),a.stopPropagation()),b};n.i=j.length;j.push(n);d.addEventListener(x[n.e]||n.e,n.proxy,n.del&&("focus"==n.e||"blur"==n.e)||!!h)})}function l(a,c,p,e,l){var h=b(a);f(c||"",p,function(b,c){d(a,b,c,e).forEach(function(b){delete m[h][b.i];
a.removeEventListener(x[b.e]||b.e,b.proxy,b.del&&("focus"==b.e||"blur"==b.e)||!!l)})})}function s(b){var c,d={originalEvent:b};for(c in b)!t.test(c)&&void 0!==b[c]&&(d[c]=b[c]);return a.each(C,function(a,c){d[a]=function(){return this[c]=A,b[a].apply(b,arguments)};d[c]=w}),d}var m={},q=1,r={},x={mouseenter:"mouseover",mouseleave:"mouseout"};r.click=r.mousedown=r.mouseup=r.mousemove="MouseEvents";a.event={add:h,remove:l};a.proxy=function(c,d){if(a.isFunction(c)){var f=function(){return c.apply(d,arguments)};
return f._zid=b(c),f}if("string"==typeof d)return a.proxy(c[d],c);throw new TypeError("expected function");};a.fn.bind=function(a,b){return this.each(function(){h(this,a,b)})};a.fn.unbind=function(a,b){return this.each(function(){l(this,a,b)})};a.fn.one=function(a,b){return this.each(function(c,d){h(this,a,b,null,function(a,b){return function(){var c=a.apply(d,arguments);return l(d,b,a),c}})})};var A=function(){return!0},w=function(){return!1},t=/^([A-Z]|layer[XY]$)/,C={preventDefault:"isDefaultPrevented",
stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(b,c,d){return this.each(function(e,f){h(f,c,d,b,function(c){return function(d){var j,e=a(d.target).closest(b,f).get(0);if(e)return j=a.extend(s(d),{currentTarget:e,liveFired:f}),c.apply(e,[j].concat([].slice.call(arguments,1)))}})})};a.fn.undelegate=function(a,b,c){return this.each(function(){l(this,b,c,a)})};a.fn.live=function(b,c){return a(document.body).delegate(this.selector,
b,c),this};a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,b,c),this};a.fn.on=function(b,c,d){return!c||a.isFunction(c)?this.bind(b,c||d):this.delegate(c,b,d)};a.fn.off=function(b,c,d){return!c||a.isFunction(c)?this.unbind(b,c||d):this.undelegate(c,b,d)};a.fn.trigger=function(b,c){if("string"==typeof b||a.isPlainObject(b))b=a.Event(b);var d=b;if(!("defaultPrevented"in d)){d.defaultPrevented=!1;var e=d.preventDefault;d.preventDefault=function(){this.defaultPrevented=!0;e.call(this)}}return b.data=
c,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(b)})};a.fn.triggerHandler=function(b,c){var f,e;return this.each(function(l,x){f=s("string"==typeof b?a.Event(b):b);f.data=c;f.target=x;a.each(d(x,b.type||b),function(a,b){e=b.proxy(f);if(f.isImmediatePropagationStopped())return!1})}),e};"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(b){a.fn[b]=
function(a){return a?this.bind(b,a):this.trigger(b)}});["focus","blur"].forEach(function(b){a.fn[b]=function(a){return a?this.bind(b,a):this.each(function(){try{this[b]()}catch(a){}}),this}});a.Event=function(a,b){"string"!=typeof a&&(b=a,a=b.type);var c=document.createEvent(r[a]||"Events"),d=!0;if(b)for(var f in b)"bubbles"==f?d=!!b[f]:c[f]=b[f];return c.initEvent(a,d,!0,null,null,null,null,null,null,null,null,null,null,null,null),c.isDefaultPrevented=function(){return this.defaultPrevented},c}})(Zepto);
(function(a){function b(b,c,d,e){if(b.global)return b=c||A,d=a.Event(d),a(b).trigger(d,e),!d.defaultPrevented}function d(a,c){var d=c.context;if(!1===c.beforeSend.call(d,a,c)||!1===b(c,d,"ajaxBeforeSend",[a,c]))return!1;b(c,d,"ajaxSend",[a,c])}function c(a,c,d){var e=d.context;d.success.call(e,a,"success",c);b(d,e,"ajaxSuccess",[c,d,a]);h("success",c,d)}function f(a,c,d,e){var f=e.context;e.error.call(f,d,c,a);b(e,f,"ajaxError",[d,e,a]);h(c,d,e)}function h(c,d,e){var f=e.context;e.complete.call(f,
d,c);b(e,f,"ajaxComplete",[d,e]);e.global&&!--a.active&&b(e,null,"ajaxStop")}function l(){}function s(a){return a&&(a=a.split(";",2)[0]),a&&(a==e?"html":a==p?"json":k.test(a)?"script":n.test(a)&&"xml")||"text"}function m(a,b){return(a+"&"+b).replace(/[&?]{1,2}/,"?")}function q(b,c,d,e){var f=!a.isFunction(c);return{url:b,data:f?c:void 0,success:f?a.isFunction(d)?d:void 0:c,dataType:f?e||d:d}}function r(b,c,d,e){var f,l=a.isArray(c);a.each(c,function(c,j){f=a.type(j);e&&(c=d?e:e+"["+(l?"":c)+"]");
!e&&l?b.add(j.name,j.value):"array"==f||!d&&"object"==f?r(b,j,d,c):b.add(c,j)})}var x=0,A=window.document,w,t,C=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,k=/^(?:text|application)\/javascript/i,n=/^(?:text|application)\/xml/i,p="application/json",e="text/html",y=/^\s*$/;a.active=0;a.ajaxJSONP=function(b){if("type"in b){var e="jsonp"+ ++x,h=A.createElement("script"),m=function(){clearTimeout(p);a(h).remove();delete window[e]},n=function(a){m();if(!a||"timeout"==a)window[e]=l;f(null,a||"abort",
k,b)},k={abort:n},p;return!1===d(k,b)?(n("abort"),!1):(window[e]=function(a){m();c(a,k,b)},h.onerror=function(){n("error")},h.src=b.url.replace(/=\?/,"="+e),a("head").append(h),0<b.timeout&&(p=setTimeout(function(){n("timeout")},b.timeout)),k)}return a.ajax(b)};a.ajaxSettings={type:"GET",beforeSend:l,success:l,error:l,complete:l,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:p,xml:"application/xml, text/xml",html:e,
text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0};a.ajax=function(e){var j=a.extend({},e||{});for(w in a.ajaxSettings)void 0===j[w]&&(j[w]=a.ajaxSettings[w]);j.global&&0===a.active++&&b(j,null,"ajaxStart");j.crossDomain||(j.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(j.url)&&RegExp.$2!=window.location.host);j.url||(j.url=window.location.toString());j.processData&&j.data&&"string"!=a.type(j.data)&&(j.data=a.param(j.data,j.traditional));j.data&&(!j.type||"GET"==j.type.toUpperCase())&&
(j.url=m(j.url,j.data));!1===j.cache&&(j.url=m(j.url,"_="+Date.now()));var h=j.dataType;e=/=\?/.test(j.url);if("jsonp"==h||e)return e||(j.url=m(j.url,"callback=?")),a.ajaxJSONP(j);e=j.accepts[h];var x={},n=/^([\w-]+:)\/\//.test(j.url)?RegExp.$1:window.location.protocol,k=j.xhr(),A;j.crossDomain||(x["X-Requested-With"]="XMLHttpRequest");e&&(x.Accept=e,-1<e.indexOf(",")&&(e=e.split(",",2)[0]),k.overrideMimeType&&k.overrideMimeType(e));if(j.contentType||!1!==j.contentType&&j.data&&"GET"!=j.type.toUpperCase())x["Content-Type"]=
j.contentType||"application/x-www-form-urlencoded";j.headers=a.extend(x,j.headers||{});k.onreadystatechange=function(){if(4==k.readyState){k.onreadystatechange=l;clearTimeout(A);var b,d=!1;if(200<=k.status&&300>k.status||304==k.status||0==k.status&&"file:"==n){h=h||s(k.getResponseHeader("content-type"));b=k.responseText;try{"script"==h?(0,eval)(b):"xml"==h?b=k.responseXML:"json"==h&&(b=y.test(b)?null:a.parseJSON(b))}catch(e){d=e}d?f(d,"parsererror",k,j):c(b,k,j)}else f(null,k.status?"error":"abort",
k,j)}};k.open(j.type,j.url,"async"in j?j.async:!0);for(t in j.headers)k.setRequestHeader(t,j.headers[t]);return!1===d(k,j)?(k.abort(),!1):(0<j.timeout&&(A=setTimeout(function(){k.onreadystatechange=l;k.abort();f(null,"timeout",k,j)},j.timeout)),k.send(j.data?j.data:null),k)};a.get=function(b,c,d,e){return a.ajax(q.apply(null,arguments))};a.post=function(b,c,d,e){var f=q.apply(null,arguments);return f.type="POST",a.ajax(f)};a.getJSON=function(b,c,d){var e=q.apply(null,arguments);return e.dataType=
"json",a.ajax(e)};a.fn.load=function(b,c,d){if(!this.length)return this;var e=this,f=b.split(/\s/),k;b=q(b,c,d);var l=b.success;return 1<f.length&&(b.url=f[0],k=f[1]),b.success=function(b){e.html(k?a("<div>").html(b.replace(C,"")).find(k):b);l&&l.apply(e,arguments)},a.ajax(b),this};var z=encodeURIComponent;a.param=function(a,b){var c=[];return c.add=function(a,b){this.push(z(a)+"="+z(b))},r(c,a,b),c.join("&").replace(/%20/g,"+")}})(Zepto);
(function(a){a.fn.serializeArray=function(){var b=[],d;return a(Array.prototype.slice.call(this.get(0).elements)).each(function(){d=a(this);var c=d.attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=c&&"reset"!=c&&"button"!=c&&("radio"!=c&&"checkbox"!=c||this.checked)&&b.push({name:d.attr("name"),value:d.val()})}),b};a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(d){a.push(encodeURIComponent(d.name)+"="+encodeURIComponent(d.value))}),
a.join("&")};a.fn.submit=function(b){b?this.bind("submit",b):this.length&&(b=a.Event("submit"),this.eq(0).trigger(b),b.defaultPrevented||this.get(0).submit());return this}})(Zepto);
(function(a,b){function d(a){return a.toLowerCase()}var c="",f,h=window.document.createElement("div"),l=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,s,m,q,r,x,A,w,t={};a.each({Webkit:"webkit",Moz:"",O:"o",ms:"MS"},function(a,k){if(h.style[a+"TransitionProperty"]!==b)return c="-"+d(a)+"-",f=k,!1});s=c+"transform";t[m=c+"transition-property"]=t[q=c+"transition-duration"]=t[r=c+"transition-timing-function"]=t[x=c+"animation-name"]=t[A=c+"animation-duration"]=t[w=c+"animation-timing-function"]=
"";a.fx={off:f===b&&h.style.transitionProperty===b,speeds:{_default:400,fast:200,slow:600},cssPrefix:c,transitionEnd:f?f+"TransitionEnd":d("TransitionEnd"),animationEnd:f?f+"AnimationEnd":d("AnimationEnd")};a.fn.animate=function(b,c,d,f){return a.isPlainObject(c)&&(d=c.easing,f=c.complete,c=c.duration),c&&(c=("number"==typeof c?c:a.fx.speeds[c]||a.fx.speeds._default)/1E3),this.anim(b,c,d,f)};a.fn.anim=function(c,f,h,p){var e,y={},z,u="",j=this,B,D=a.fx.transitionEnd;f===b&&(f=0.4);a.fx.off&&(f=0);
if("string"==typeof c)y[x]=c,y[A]=f+"s",y[w]=h||"linear",D=a.fx.animationEnd;else{z=[];for(e in c)l.test(e)?u+=e+"("+c[e]+") ":(y[e]=c[e],z.push(d(e.replace(/([a-z])([A-Z])/,"$1-$2"))));u&&(y[s]=u,z.push(s));0<f&&"object"==typeof c&&(y[m]=z.join(", "),y[q]=f+"s",y[r]=h||"linear")}return B=function(b){if("undefined"!=typeof b){if(b.target!==b.currentTarget)return;a(b.target).unbind(D,B)}a(this).css(t);p&&p.call(this)},0<f&&this.bind(D,B),this.size()&&this.get(0).clientLeft,this.css(y),0>=f&&setTimeout(function(){j.each(function(){B.call(this)})},
0),this};h=null})(Zepto);
(function(a){function b(){var b={},c=Function,f,h=a;f=h.postMessage instanceof c?function(a){var b=Math.random(),c=function(d){d.data===b&&(a(),h.removeEventListener("message",c,!0))};h.addEventListener("message",c,!0);h.postMessage(b,"*")}:typeof h.process!==undefType&&h.process.nextTick instanceof c?function(a){process.nextTick(a)}:h.setTimeout instanceof c?function(a){h.setTimeout(a,0)}:function(a){a()};return{publish:function(){var c=arguments,h=b[c[0]],m,q,r;h&&(m=h.length,q=1<c.length?Array.prototype.splice.call(c,
1):[],f(function(){for(r=0;r<m;r+=1)h[r].apply(a,q);h=a=q=null}))},subscribe:function(a,f){if("string"!==typeof a)throw"invalid or missing channel";if(!(f instanceof c))throw"invalid or missing callback";b[a]||(b[a]=[]);b[a].push(f);return{channel:a,callback:f}},unsubscribe:function(a,f){a.channel&&a.callback&&(f=a.callback,a=a.channel);if("string"!==typeof a)throw"invalid or missing channel";if(!(f instanceof c))throw"invalid or missing callback";var h=b[a],q,r=h instanceof Array?h.length:0;for(q=
0;q<r;q+=1)if(h[q]===f){h.splice(q,1);break}}}}"function"===typeof define&&define.amd?define("pubsub",b):"object"===typeof module&&module.exports?module.exports=b():a.PubSub=b()})(this);
function FastClick(a){var b,d=this;this.trackingClick=!1;this.trackingClickStart=0;this.targetElement=null;this.lastTouchIdentifier=this.touchStartY=this.touchStartX=0;this.layer=a;if(!a||!a.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return FastClick.prototype.onClick.apply(d,arguments)};this.onMouse=function(){return FastClick.prototype.onMouse.apply(d,arguments)};this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(d,arguments)};this.onTouchEnd=
function(){return FastClick.prototype.onTouchEnd.apply(d,arguments)};this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(d,arguments)};"undefined"!==typeof window.ontouchstart&&(this.deviceIsAndroid&&(a.addEventListener("mouseover",this.onMouse,!0),a.addEventListener("mousedown",this.onMouse,!0),a.addEventListener("mouseup",this.onMouse,!0)),a.addEventListener("click",this.onClick,!0),a.addEventListener("touchstart",this.onTouchStart,!1),a.addEventListener("touchend",this.onTouchEnd,
!1),a.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(a.removeEventListener=function(b,d,h){var l=Node.prototype.removeEventListener;"click"===b?l.call(a,b,d.hijacked||d,h):l.call(a,b,d,h)},a.addEventListener=function(b,d,h){var l=Node.prototype.addEventListener;"click"===b?l.call(a,b,d.hijacked||(d.hijacked=function(a){a.propagationStopped||d(a)}),h):l.call(a,b,d,h)}),"function"===typeof a.onclick&&(b=a.onclick,a.addEventListener("click",function(a){b(a)},
!1),a.onclick=null))}FastClick.prototype.deviceIsAndroid=0<navigator.userAgent.indexOf("Android");FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent);FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent);FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);
FastClick.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case "button":case "input":return this.deviceIsIOS&&"file"===a.type?!0:a.disabled;case "label":case "video":return!0;default:return/\bneedsclick\b/.test(a.className)}};
FastClick.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case "textarea":case "select":return!0;case "input":switch(a.type){case "button":case "checkbox":case "file":case "image":case "radio":case "submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}};
FastClick.prototype.sendClick=function(a,b){var d,c;document.activeElement&&document.activeElement!==a&&document.activeElement.blur();c=b.changedTouches[0];d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);d.forwardedTouchEvent=!0;a.dispatchEvent(d)};FastClick.prototype.focus=function(a){var b;this.deviceIsIOS&&a.setSelectionRange?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()};
FastClick.prototype.updateScrollParent=function(a){var b,d;b=a.fastClickScrollParent;if(!b||!b.contains(a)){d=a;do{if(d.scrollHeight>d.offsetHeight){b=d;a.fastClickScrollParent=d;break}d=d.parentElement}while(d)}b&&(b.fastClickLastScrollTop=b.scrollTop)};FastClick.prototype.getTargetElementFromEventTarget=function(a){return a.nodeType===Node.TEXT_NODE?a.parentNode:a};
FastClick.prototype.onTouchStart=function(a){var b,d,c;b=this.getTargetElementFromEventTarget(a.target);d=a.targetTouches[0];if(this.deviceIsIOS){c=window.getSelection();if(c.rangeCount&&!c.isCollapsed)return!0;if(!this.deviceIsIOS4){if(d.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=d.identifier;this.updateScrollParent(b)}}this.trackingClick=!0;this.trackingClickStart=a.timeStamp;this.targetElement=b;this.touchStartX=d.pageX;this.touchStartY=d.pageY;
200>a.timeStamp-this.lastClickTime&&a.preventDefault();return!0};FastClick.prototype.touchHasMoved=function(a){a=a.changedTouches[0];return 10<Math.abs(a.pageX-this.touchStartX)||10<Math.abs(a.pageY-this.touchStartY)?!0:!1};FastClick.prototype.findControl=function(a){return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};
FastClick.prototype.onTouchEnd=function(a){var b,d,c;c=this.targetElement;this.touchHasMoved(a)&&(this.trackingClick=!1,this.targetElement=null);if(!this.trackingClick)return!0;if(200>a.timeStamp-this.lastClickTime)return this.cancelNextClick=!0;this.lastClickTime=a.timeStamp;b=this.trackingClickStart;this.trackingClick=!1;this.trackingClickStart=0;this.deviceIsIOSWithBadTarget&&(c=a.changedTouches[0],c=document.elementFromPoint(c.pageX-window.pageXOffset,c.pageY-window.pageYOffset));d=c.tagName.toLowerCase();
if("label"===d){if(b=this.findControl(c)){this.focus(c);if(this.deviceIsAndroid)return!1;c=b}}else if(this.needsFocus(c)){if(100<a.timeStamp-b||this.deviceIsIOS&&window.top!==window&&"input"===d)return this.targetElement=null,!1;this.focus(c);if(!this.deviceIsIOS4||"select"!==d)this.targetElement=null,a.preventDefault();return!1}if(this.deviceIsIOS&&!this.deviceIsIOS4&&(b=c.fastClickScrollParent)&&b.fastClickLastScrollTop!==b.scrollTop)return!0;this.needsClick(c)||(a.preventDefault(),this.sendClick(c,
a));return!1};FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1;this.targetElement=null};FastClick.prototype.onMouse=function(a){return!this.targetElement||a.forwardedTouchEvent||!a.cancelable?!0:!this.needsClick(this.targetElement)||this.cancelNextClick?(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1):!0};
FastClick.prototype.onClick=function(a){if(this.trackingClick)return this.targetElement=null,this.trackingClick=!1,!0;if("submit"===a.target.type&&0===a.detail)return!0;a=this.onMouse(a);a||(this.targetElement=null);return a};
FastClick.prototype.destroy=function(){var a=this.layer;this.deviceIsAndroid&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0));a.removeEventListener("click",this.onClick,!0);a.removeEventListener("touchstart",this.onTouchStart,!1);a.removeEventListener("touchend",this.onTouchEnd,!1);a.removeEventListener("touchcancel",this.onTouchCancel,!1)};FastClick.attach=function(a){return new FastClick(a)};
"undefined"!==typeof define&&define.amd&&define(function(){return FastClick});"undefined"!==typeof module&&module.exports&&(module.exports=FastClick.attach,module.exports.FastClick=FastClick);(function(a){"__proto__"in{}||a.extend(a.zepto,{Z:function(b,d){b=b||[];a.extend(b,a.fn);b.selector=d||"";return b}})})(Zepto);window.$hn={};
(function(a){a.t=function(a,b){for(var f in b)a=a.replace(RegExp("{"+f+"}","g"),b[f]);return a};var b=0;a.debug={domInsert:function(a){b=a},showLog:function(){$(".debug-log").html(["<div>Dom Update Count: "+b+"</div>",""].join(""))}};a.ajax=$.ajax;$.os.ios&&(a.fastClick=FastClick.attach(document.body));(a=document.querySelector(".css-style-android"))&&($.os.android&&!$("html").hasClass("android-chrome"))&&cssStyle(a.innerHTML)})(window.$hn);
(function(a){var b=document.getElementById("loading");a.loading={hide:function(){b.className=""},show:function(a,c){b.setAttribute("style","top: "+c+"px; left: "+a+"px;");b.className="show-loading"},isVisible:function(){return"show-loading"===b.className}}})(window.$hn);
(function(){$hn.onClick=function(a,b){$(document).on("click",a,function(a){var c=$(a.target).closest("A");if(!(0==c.length||0<c.length&&0!==c.attr("href").indexOf("#"))){a.preventDefault();var f=document.elementFromPoint(a.clientX,a.clientY),h=$hn.loading;window.setTimeout(function(){f==document.elementFromPoint(a.clientX,a.clientY)&&!h.isVisible()&&(h.show(a.clientX,a.clientY),b(c,a))},11)}})}})();
(function(){var a={comments:"show-comments",article:"show-article"},b=location.hash,d=b;0<d.length?(d=d.split("#")[1].split("/"),a[d[1]]&&window.setTimeout(function(){PubSub.publish(a[d[1]],d[2])},100)):history.replaceState({publish:"show-home",url:location.href},"Home",location.href);$(window).on("popstate",function(a){a.state&&b!=a.state.url&&a.state.publish&&(a.state.args?PubSub.publish(a.state.publish,a.state.args):PubSub.publish(a.state.publish))});$(window).on("hashchange",function(){});$(window).on("load",
function(){});document.addEventListener("menubutton",function(){alert("hardware menu button")},!1);document.addEventListener("backbutton",function(){alert("hardware back button")},!1)})();
(function(a){a.timeAgo=function(a,d){!d&&(d=Date.now());if(!("number"!==typeof a||"number"!==typeof d)){var c=Math.abs((d-a)/1E3),f=new Date,h="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");f.setTime(a);return 60>=c?"Just now!":3600>c?Math.round(Math.abs(c/60))+" minute"+(1!=Math.round(Math.abs(c/60))?"s":"")+" ago":86400>c?Math.round(Math.abs(c/3600))+" hour"+(1!=Math.round(Math.abs(c/3600))?"s":"")+" ago":h[f.getMonth()]+" "+f.getDate()+" "+f.getFullYear()}}})(window.$hn);(function(a){var b={list:"/news",item:"/item/{id}",viewText:"http://viewtext.org/api/text?url={url}&format={format}",AskHn:'https://api.thriftdb.com/api.hnsearch.com/items/_search?limit=30&sortby=create_ts+desc&weights[username]=0.1&weights[text]=1&weights[type]=0&weights[domain]=2&weights[title]=1.2&weights[url]=1&boosts[fields][points]=0.07&boosts[functions][pow(2,div(div(ms(create_ts,NOW),3600000),72))]=200&q="Ask+hn"&filter[fields][type]=submission&facet[queries][]=username:Ask&facet[queries][]=username:hn',
ShowHn:'https://api.thriftdb.com/api.hnsearch.com/items/_search?limit=30&sortby=create_ts+desc&weights[username]=0.1&weights[text]=1&weights[type]=0&weights[domain]=2&weights[title]=1.2&weights[url]=1&boosts[fields][points]=0.07&boosts[functions][pow(2,div(div(ms(create_ts,NOW),3600000),72))]=200&q="show+hn"&filter[fields][type]=submission&facet[queries][]=username:show&facet[queries][]=username:hn',top10ByDate:"https://api.thriftdb.com/api.hnsearch.com/items/_search?filter[fields][type][]=submission&sortby=points+desc&filter[fields][create_ts][]=[{startDate}+TO+{endDate}]&limit=10",
viewText:"http://premii.com/hn/readability.php?apikey=premii.com/one&url={url}"},d=function(c){if("list"==c||"item"==c)return"http://n.premii.com:8080"+b[c];if("AskHn"==c||"ShowHn"==c)return b[c];if("todayTop10"==c||"yesterdayTop10"==c||"weekTop10"==c){var d=new Date,f;d.setHours(0);d.setMinutes(0);d.setSeconds(0);f=new Date(d);"todayTop10"==c?f.setHours(24):"yesterdayTop10"==c?d.setHours(-24):"weekTop10"==c&&d.setDate(d.getDate()-7);return a.t(b.top10ByDate,{startDate:d.toISOString(),endDate:f.toISOString()})}},
c={},f=null,h=function(){f=null;window.localStorage.setItem("visited",JSON.stringify(c))},l=function(){f&&(window.clearTimeout(f),f=null);f=window.setTimeout(h,1E3)},s=function(a,b){c[a]||(c[a]={});c[a][b]=1;c[a].d=+new Date;l()};window.setTimeout(function(){var a=window.localStorage.getItem("visited");a&&(a=$.parseJSON(a),$.extend(!0,c,a),$.each(c,function(a,b){b[a]&&b[a].d<+new Date-86418074&&delete b[a]}),l())},1);var m;m={articles:{}};var q=0,r=function(c,d){d=d||function(){};!m.articles[c]&&
3>q++&&window.setTimeout(function(){r(c,d)},400);var f=+new Date;a.ajax({url:a.t(b.viewText,{url:encodeURIComponent(m.articles[c].url),format:"jsonp"}),dataType:"jsonp",success:function(b){a.perf.update(c,"content-fetch",+new Date-f);m.articles[c].content=b.content;d.apply(d,[m.articles[c]])},error:function(){alert("Hmm, Something went wrong!")}})};a.data={getArticles:function(b,f){b=b||function(){};if(!f&&m.list)return b.apply(b,[m.list]);var h=b,h=h||function(){},l=+new Date;a.ajax({url:d("list")+
"?t="+ +new Date,success:function(b){m={articles:{}};a.perf.update("list","fetch",+new Date-l);m.list=b;$.each(m.list,function(a,b){b.visitedComments="";b.visitedArticle="";c[b.id]&&(c[b.id].a&&(b.visitedArticle="visited"),c[b.id].c&&(b.visitedComments="visited"));m.articles[b.id]=b});h.apply(h,[m.list])},error:function(){}})},getArticleMeta:function(a,b){b=b||function(){};var c=m.articles[a];if(c)return b.apply(b,[c]);r(a,b)},getArticleContent:function(a,b,c){c=c||!1;b=b||function(){};s(a,"a");var d=
m.articles[a];if(!c&&d&&d.content)return b.apply(b,[d]);r(a,b)},getArticleComments:function(b,c,f){f=f||!1;c=c||function(){};s(b,"c");var h=m.articles[b];if(!f&&h&&h.comments)return c.apply(c,[h]);var l=c,l=l||function(){},k=+new Date;a.ajax({url:a.t(d("item"),{id:b}),dataType:"jsonp",success:function(c){a.perf.update(b,"comments-fetch",+new Date-k);var d=m.articles[b];d?d.comments=c.comments:d=m.articles[b]=c;d.commentsFetchTime=+new Date;l.apply(l,[d])}})},getArticlesByType:function(b,f,h){f=f||
function(){};if(!h&&m["list"+b])return f.apply(f,[m["list"+b]]);var l=f,l=l||function(){},r=+new Date;a.ajax({url:d(b),dataType:"jsonp",success:function(d){a.perf.update("list"+b,"fetch",+new Date-r);var f=m,h="list"+b,e=+new Date,s=[];$.each(d.results,function(b,d){d=d.item;var e={id:d.id,comments_count:d.num_comments,domain:d.domain,points:d.points,time_ago:a.timeAgo(+new Date(d.create_ts)),title:d.title,text:d.text||"",type:d.type,url:d.url,user:d.username,visitedArticle:"",visitedComments:""};
c[d.id]&&(c[d.id].c&&(e.visitedComments="visited"),c[d.id].a&&(e.visitedArticle="visited"));m.articles[d.id]=e;s.push(e)});a.perf.update("listAskHn","reformat",+new Date-e);f[h]=s;l.apply(l,[m["list"+b]])}})},cache:function(){return m}}})(window.$hn);(function(a){var b={insertedNodeCount:0};a.perf={update:function(a,c,f){b[a]||(b[a]={});2==arguments.length?b[a]=arguments[1]:b[a][c]=(b[a][c]?b[a][c]+",":"")+f},data:b};document.body.addEventListener("DOMNodeInserted",function(){},!1)})(window.$hn);(function(a){document.querySelector("html").classList.add("show-app");var b=$(".page-home"),d=$(".bd",b);PubSub.subscribe("show-home",function(){a.loading.hide();a.showPage("page-home")});var c=$(".template-list-item").html(),f=function(b){var f="",h=+new Date;$.each(b,function(b,d){d.domain&&d.url?(d.self=!1,d.urlTitle=d.url.replace("http://","").replace("https://","")):(d.self=!0,d.urlTitle="");d.text=d.text||"";d.id&&(f+=a.t(c,d))});a.loading.hide();d.parent().get(0).scrollTop=0;d[0].innerHTML=
'<ul class="list">'+f+"</ul>";a.perf.update("list","render",+new Date-h)},h=function(c){a.data.getArticles(f,c||!1);$("h1",b)[0].innerHTML="Hacker News"};PubSub.subscribe("filter-home",function(c,d){a.data.getArticlesByType(c,f);$("h1",b)[0].innerHTML=d});PubSub.subscribe("reload-home",function(){h(!0)});PubSub.subscribe("load-home",h);h()})(window.$hn);
(function(a){$(".page");a.showPage=function(a){var d=$(".show-page");d.hasClass(a)||(d.removeClass("show-page"),PubSub.publish("onPageHidden",d.data("page")),$("."+a).addClass("show-page"))}})(window.$hn);
(function(a){var b=$(".page-article-content");PubSub.subscribe("show-article",function(d){var c=$(".template-page-article").html();a.data.getArticleMeta(d,function(f){a.loading.hide();f=a.t(c,f);b[0].innerHTML=f;$(".article-content",b)[0].style.height="5000px";a.showPage("page-article-content");a.data.getArticleContent(d,function(c){var f=+new Date,s=$(".article-content",b)[0];s.innerHTML=c.content;s.style.height="auto";a.perf.update(d,"article-render",+new Date-f)})})});PubSub.subscribe("onPageHidden",
function(a){"page-article-content"==a&&window.setTimeout(function(){b[0].innerHTML=""},300)})})(window.$hn);
(function(a){var b=$(".page-article-comments"),d=$(".template-comment-item").html(),c=function(b){var h="";$.each(b,function(b,f){var m=$.extend({},f);m.comments&&(m.child_comments=c(m.comments));h+=a.t(d,m)});return"<ul>"+h+"</ul>"};PubSub.subscribe("onPageHidden",function(a){"page-article-comments"==a&&window.setTimeout(function(){b[0].innerHTML=""},300)});PubSub.subscribe("show-comments",function(d){var h=$(".template-page-article-comments").html();a.data.getArticleMeta(d,function(l){a.loading.hide();
l=a.t(h,l);b[0].innerHTML=l;$(".article-comments",b)[0].style.height="5000px";a.showPage("page-article-comments");a.data.getArticleComments(d,function(h){var l=+new Date,q=$(".article-comments",b)[0];q.innerHTML=c(h.comments);q.style.height="auto";a.perf.update(d,"comments-render",+new Date-l)})})})})(window.$hn);
(function(a){PubSub.subscribe("show-performance",function(){var b=$(".page-performance"),d=$(".template-page-performance").html();b[0].innerHTML=d;var c="";$.each(a.perf.data,function(a,b){c+="<h4>"+a+"</h4>";"object"==typeof b?$.each(b,function(a,b){c+="<div>"+a+": "+b+"</div>"}):c+="<div>"+b+"</div>"});$(".bd",b)[0].innerHTML=c;a.showPage("page-performance")});a.onClick(".page-performance a",function(a){a.hasClass("back-home")&&PubSub.publish("show-home")},!1)})(window.$hn);
(function(a){a.onClick(".page-home a",function(b){var d=b.closest("LI");b.hasClass("story")?!0==b.data("hn")?a.loading.hide():(history.pushState({publish:"show-article",args:d.data("id"),url:b.attr("href")},"Article",b.attr("href")),PubSub.publish("show-article",d.data("id")),b.addClass("visited")):b.hasClass("comments")?(history.pushState({publish:"show-comments",args:d.data("id"),url:b.attr("href")},"Article",b.attr("href")),PubSub.publish("show-comments",d.data("id")),b.addClass("visited")):b.hasClass("reload")?
PubSub.publish("reload-home"):b.hasClass("toggle-submenu")?(a.loading.hide(),b.closest("li").toggleClass("show-submenu")):b.hasClass("filter-fp")?($(".show-submenu").removeClass("show-submenu"),PubSub.publish("load-home",b.text())):b.hasClass("filter-ask-hn")?($(".show-submenu").removeClass("show-submenu"),PubSub.publish("filter-home","AskHn",b.text())):b.hasClass("filter-show-hn")?($(".show-submenu").removeClass("show-submenu"),PubSub.publish("filter-home","ShowHn",b.text())):b.hasClass("filter-today-top-10")?
($(".show-submenu").removeClass("show-submenu"),PubSub.publish("filter-home","todayTop10",b.text())):b.hasClass("filter-week-top-10")?($(".show-submenu").removeClass("show-submenu"),PubSub.publish("filter-home","weekTop10",b.text())):b.hasClass("filter-yesterday-top-10")?($(".show-submenu").removeClass("show-submenu"),PubSub.publish("filter-home","yesterdayTop10",b.text())):b.hasClass("show-performance")&&(a.loading.hide(),PubSub.publish("show-performance"),$(".show-submenu").removeClass("show-submenu"))},
!0)})(window.$hn);
(function(a){a.onClick(".header a",function(b){b.hasClass("back-home")?(a.loading.hide(),history.back()):b.hasClass("show-comments")?(history.pushState({publish:"show-comments",args:b.data("id"),url:b.attr("href")},"Comments",b.attr("href")),PubSub.publish("show-comments",b.data("id"))):b.hasClass("show-article")?(history.pushState({publish:"show-article",args:b.data("id"),url:b.attr("href")},"Article",b.attr("href")),PubSub.publish("show-article",b.data("id"))):a.loading.hide()},!0)})(window.$hn);
(function(a){var b=function(b){var c=$(b.target);a.loading.hide();if(0<c.closest(".article-comments").length||0<c.closest(".article-content").length)nativeApp?(b.preventDefault(),window.open(c.attr("href"),"_blank","location=yes")):c.attr("target","_blank")};$(document).on("click",".page-article-comments a",b);$(document).on("click",".page-article-content a",b)})(window.$hn);
